# This file auto-generated by /home/steveri/tmpdir/pipegen.sh
# Fri Sep 25 13:36:48 PDT 2020

agents: { queue: "papers" }

env:
  GOLD: /build/gold.${BUILDKITE_BUILD_NUMBER}/full_chip

steps:

- label: 'setup'
  commands:
  - 'source mflowgen/bin/setup-buildkite.sh --dir $$GOLD;
     mflowgen run --design $$GARNET_HOME/mflowgen/full_chip'
- wait: ~

- label: 'rtl'
  commands:
  - 'source mflowgen/bin/setup-buildkite.sh --dir $$GOLD --need_space 100G;
     echo "--- MAKE RTL"; set -o pipefail;
     make rtl |& tee make-rtl.log'
- wait: ~

# - label: 'tile_array'
#   commands:
#   - 'source mflowgen/bin/setup-buildkite.sh --dir $$GOLD --need_space 100G;
#      echo "--- MAKE TILE_ARRAY"; set -o pipefail;
#      make tile_array |& tee make-tile_array.log'
# - wait: ~

# Does this work to bypass tile_array build???
- label: 'tile_array'
  commands:
  - 'source mflowgen/bin/setup-buildkite.sh --dir $$GOLD --need_space 100G;
     echo "--- MAKE TILE_ARRAY"; set -o pipefail;
     cp -rp /sim/buildkite-agent/gold/17-tile_array/ .
     echo "-------------"
     make -n tile_array
     echo "-------------"
     make tile_array |& tee make-tile_array.log'
- wait: ~
