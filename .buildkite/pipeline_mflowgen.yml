# [sr 2002] Added waits between each step.
# Each one seems to try and max out resources.
# Why make them run in parallel??
#
steps:

- label: 'test'
  command: 'echo a;
  echo b'
  agents: { jobsize: "hours" }



- label: 'pad_frame'
  command: '
    pwd; echo $HOME; echo $USER; echo $BUILDKITE_BUILD_NUMBER;
    tmp=/tmp/bklog.$BUILDKITE_BUILD_NUMBER;
    echo $tmp; touch $tmp;
    mflowgen/test/test_module.sh pad_frame
      || echo $BUILDKITE_LABEL FAILED >> $tmp'
  agents: { jobsize: "hours" }

- wait ###########################################################

- label: 'CHECK'
  commands:
  - echo hello $tmp
  - tmp=/tmp/bklog.$BUILDKITE_BUILD_NUMBER
  - grep FAIL $tmp && exit 13

- wait ###########################################################




- label: 'icovl'
  command: mflowgen/test/test_module.sh icovl
  agents: { jobsize: "hours" }

- wait ###########################################################

- label: 'Tile_PE'
  command: mflowgen/test/test_module.sh --verbose Tile_PE
  agents: { jobsize: "hours" }

- wait ###########################################################

- label: 'Tile_MemCore'
  command: mflowgen/test/test_module.sh Tile_MemCore
  agents: { jobsize: "hours" }


