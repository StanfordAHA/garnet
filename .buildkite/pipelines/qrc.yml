# To test QRC robustness, uses helper script qrc.sh to do ten
# consecutive postroute_hold runs, two at a time; this test
# takes about five hours for each run pair, so about 25 hours
# for the entire test.

agents: { queue: "papers" }

env:
  DESTDIR : /build/qtry${BUILDKITE_BUILD_NUMBER}

steps:
  - command: '
  (echo foo | grep bar) || ENDSTATUS=FAIL;
  if [ "$$ENDSTATUS" == "FAIL" ]; then echo try again; else echo guess we good; fi
  '
  - command: '
  (echo foo | grep foo) || ENDSTATUS=FAIL;
  if [ "$$ENDSTATUS" == "FAIL" ]; then echo try again; else echo guess we good; fi
  '






# - label:    'qrc0'
#   commands: 
#   - '
#     echo foo; export FOO=barzy;
#     echo fi;
#   '
#   - 'echo $$FOO ; exit 13'
#   - wait: { continue_on_failure: true }
#   - 'if [ $$FOO' == 'barzy' ] ; then echo barzyyyy; fi'
# 
# 
# - label:    'qrc1'
#   commands: 'echo faw'
# 
# # 
# # 
# 
# # - label:    'qrc1'
# #   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-1'
# # - wait:     { continue_on_failure: true }
# # 
# 
# 
# 
# 
# 
# 
# 








# steps:
# - label:    'qrc0'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-0'
# - label:    'qrc1'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-1'
# - wait:     { continue_on_failure: true }
# 
# 
# - label:    'qrc2'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-2'
# - label:    'qrc3'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-3'
# - wait:     { continue_on_failure: true }
# 
# 
# - label:    'qrc4'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-4'
# - label:    'qrc5'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-5'
# - wait:     { continue_on_failure: true }
# 
# 
# - label:    'qrc6'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-6'
# - label:    'qrc7'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-7'
# - wait:     { continue_on_failure: true }
# 
# 
# - label:    'qrc8'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-8'
# - label:    'qrc9'
#   commands: '.buildkite/bin/qrc.sh $${DESTDIR}-9'
# - wait:     { continue_on_failure: true }
# 
# 
# ########################################################################
# # Builds this data structure...?
# # {
# #  'agents' : { 'queue' : 'papers' },
# #  'env'    : { 'DESTDIR' : '/build/qtry3456' },
# #  'steps'  : [ 
# #               { 'label' : 'qrc0' , 'commands' : 'qrc.sh' },
# #               { 'label' : 'qrc1' , 'commands' : 'qrc.sh' },
# #               { 'wait'  : { 'cf' : 'true' } }
# #             ]
# # }
